# the dockerfile to install openssh-server in ubuntu
# this dockerfile is copied from 
# https://stackoverflow.com/questions/40801417/installing-ssh-in-the-docker-containers
# This image build was stuck due to time zone data (tzdata) missing. 
# Hack I have found from
# https://grigorkh.medium.com/fix-tzdata-hangs-docker-image-build-cdb52cc3360d

FROM ubuntu:latest

ENV TZ=Europe/Helsinki
RUN ln -snf /usr/share/zoneinfo/$TZ /etc/localtime && echo $TZ > /etc/timezone

RUN apt update && apt install -y tzdata openssh-server apache2 supervisor sudo
RUN useradd -rm -d /home/masum -s /bin/bash -g root -G sudo -u 1000 masum
RUN echo 'masum:strongpassword' | chpasswd
RUN echo "masum ALL=(ALL:ALL) NOPASSWD: ALL" >> /etc/sudoers.d/10_masum

COPY supervisord.conf /etc/supervisor/conf.d/supervisord.conf

EXPOSE 22 80

CMD ["/usr/bin/supervisord"]
